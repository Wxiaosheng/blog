### JS执行机制：调用栈 - 为什么 JavaScript 代码会栈溢出？

当一段JS代码被执行时，JavaScript 引擎先会对其进行编译，并创建执行上下文，哪些情况下代码才算是“一段”代码？

* 当 JavaScript 执行全局代码的时候，会编译全局代码并创建全局执行上下文，而且在整个页面的生存周期内，全局执行上下文只有一份

* 当调用一个函数的时候，函数体内的代码会被编译，并创建函数执行上下文，一般情况下，函数执行结束之后，创建的函数执行上下文会被销毁

* 当使用 eval 函数的时候，eval 的代码也会被编译，并创建执行上下文

#### 调用栈
调用栈就是用来管理函数调用关系的一种数据结构

##### 什么是函数调用
函数调用就是运行一个函数，具体使用方式是使用函数名称跟着一对小括号，JS引擎会执行以下操作
1. 从 全局执行上下文中，取出 被调用函数的代码
2. 对被调用函数的代码 进行编译，并创建该函数的执行上下文 和 可执行代码
3. 执行代码，输出结果

##### 调用栈
> 在执行 JavaScript 时，可能会存在多个执行上下文，那么 JavaScript 引擎是如何管理这些执行上下文的呢？

答案是 **通过一种叫栈的数据结构来管理的**

在执行上下文创建好后，JavaScript 引擎会将执行上下文压入栈中，通常把这种用来管理执行上下文的栈称为执行上下文栈，又称调用栈

**调用栈是 JavaScript 引擎追踪函数执行的一个机制**

#### 开发中如何利用好调用栈
1. 利用浏览器查看调用栈的信息
  * 打断点调试，通过 `call stack` 查看当前函数的调用关系， 最低层的 `anonymous` 表示全局函数的入口 （anonymous - 匿名）
  * 可以通过 `console.track()` 输出当前函数的调用关系 （track - 追踪）
2. 栈溢出 （Stack Overflow）
  * 调用栈是有大小的，当入栈的执行上下文超过一定数目，JavaScript 引擎就会报错，我们把这种错误叫做栈溢出


#### 总结
* 每调用一个函数，JavaScript 引擎会为其创建执行上下文，并把该执行上下文压入调用栈，然后 JavaScript 引擎开始执行函数代码
* 如果在一个函数 A 中调用了另外一个函数 B，那么 JavaScript 引擎会为 B 函数创建执行上下文，并将 B 函数的执行上下文压入栈顶
* 当前函数执行完毕后，JavaScript 引擎会将该函数的执行上下文弹出栈
* 当分配的调用栈空间被占满时，会引发“堆栈溢出”问题

